<svg id="mermaid-svg" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 777.53515625px;" viewBox="-8 -8 777.53515625 2237.34375" role="graphics-document document" aria-roledescription="flowchart-v2" xmlns:xlink="http://www.w3.org/1999/xlink"><style>#mermaid-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg .cluster-label text{fill:#333;}#mermaid-svg .cluster-label span{color:#333;}#mermaid-svg .label text,#mermaid-svg span{fill:#333;color:#333;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .node .label{text-align:center;}#mermaid-svg .node.clickable{cursor:pointer;}#mermaid-svg .arrowheadPath{fill:#333333;}#mermaid-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg .cluster text{fill:#333;}#mermaid-svg .cluster span{color:#333;}#mermaid-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 12 20" refX="10" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M308.1171875,34L308.1171875,38.166666666666664C308.1171875,42.333333333333336,308.1171875,50.666666666666664,308.2005208333333,59.083333333333336C308.2838541666667,67.5,308.4505208333333,76,308.5338541666667,80.25L308.6171875,84.5" id="L-A-B-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M435.4531119757253,464.5234505242747L462.3105360214377,491.3294379368956C489.1679600671502,518.1354253495165,542.8828081585751,571.7474001747582,569.7402322042875,604.3033875873791C596.59765625,636.859375,596.59765625,648.359375,596.59765625,654.109375L596.59765625,659.859375" id="L-B-C-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M271.2271713847479,553.969358884748L269.0701688622899,565.8676949039567C266.91316633983195,577.7660309231653,262.599161294916,601.5627029615827,260.52549210579133,626.221455647458C258.4518229166667,650.8802083333334,258.6184895833333,676.4010416666666,258.7018229166667,689.1614583333334L258.78515625,701.921875" id="L-B-D-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-D" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M228.98147447098103,918.868193220981L223.27818185081753,936.429223517484C217.574889230654,953.9902538139874,206.16830399032702,989.1123144069937,194.8749168577439,1015.2451285969313C183.58152972516078,1041.3779427868687,172.40134070032158,1058.5215105737375,166.81124618790196,1067.093294467172L161.22115167548236,1075.6650783606062" id="L-D-E-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M322.9520312734989,884.5049999765012L348.1976562695824,907.7932291470843C373.443281265666,931.0814583176674,423.934531257833,977.6579166588336,432.1456283936436,1021.2404166627502C440.35672552945425,1064.8229166666667,406.2876698089085,1105.4114583333333,389.2531419486357,1125.7057291666667L372.2186140883628,1146" id="L-D-F-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-F" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M368.4891982012269,1180L380.0899568343557,1198.7109375C391.69071546748455,1217.421875,414.8922327337423,1254.84375,426.49299136687114,1277.7213541666667C438.09375,1300.5989583333333,438.09375,1308.9322916666667,438.09375,1313.0989583333333L438.09375,1317.265625" id="L-F-G-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M438.09375,1351.265625L438.09375,1357.015625C438.09375,1362.765625,438.09375,1374.265625,438.09375,1385.765625C438.09375,1397.265625,438.09375,1408.765625,438.09375,1414.515625L438.09375,1420.265625" id="L-G-H-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M438.09375,1454.265625L438.09375,1458.4322916666667C438.09375,1462.5989583333333,438.09375,1470.9322916666667,433.8975889024653,1488.4268857774653C429.7014278049307,1505.921479888264,421.3091056098613,1532.577334776528,417.1129445123267,1545.90526222066L412.916783414792,1559.233189664792" id="L-H-I-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M358.44921875,1950.84375L358.3658854166667,1956.5104166666667C358.2825520833333,1962.1770833333333,358.1158854166667,1973.5104166666667,358.0325520833333,1984.9270833333333C357.94921875,1996.34375,357.94921875,2007.84375,357.94921875,2013.59375L357.94921875,2019.34375" id="L-I-J-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M357.94921875,2053.34375L357.94921875,2057.5104166666665C357.94921875,2061.6770833333335,357.94921875,2070.0104166666665,357.94921875,2078.34375C357.94921875,2086.6770833333335,357.94921875,2095.0104166666665,357.94921875,2099.1770833333335L357.94921875,2103.34375" id="L-J-K-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-J LE-K" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M357.94921875,2137.34375L357.94921875,2141.5104166666665C357.94921875,2145.6770833333335,357.94921875,2154.0104166666665,340.2060081845238,2162.34375C322.46279761904765,2170.6770833333335,286.97637648809524,2179.0104166666665,269.2331659226191,2183.1770833333335L251.48995535714286,2187.34375" id="L-K-L-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-L" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M147.04557291666666,2187.34375L139.18967013888889,2183.1770833333335C131.33376736111111,2179.0104166666665,115.62196180555554,2170.6770833333335,107.76605902777777,2159.5104166666665C99.91015625,2148.34375,99.91015625,2134.34375,99.91015625,2120.34375C99.91015625,2106.34375,99.91015625,2092.34375,99.91015625,2078.34375C99.91015625,2064.34375,99.91015625,2050.34375,99.91015625,2034.7604166666667C99.91015625,2019.1770833333333,99.91015625,2002.0104166666667,99.91015625,1950.50390625C99.91015625,1898.9973958333333,99.91015625,1813.1510416666667,99.91015625,1728.8880208333333C99.91015625,1644.625,99.91015625,1561.9453125,140.634765625,1515.5477615597026C181.359375,1469.150210619405,262.80859375,1459.0347962388103,303.533203125,1453.977089048513L344.2578125,1448.9193818582155" id="L-L-H-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-H" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M291.15707310774144,1572.0577706422587L284.4277692564512,1556.5924130352157C277.69846540516096,1541.1270554281725,264.2398577025805,1510.1963402140864,257.51055385129024,1487.7309826070432C250.78125,1465.265625,250.78125,1451.265625,250.78125,1435.6822916666667C250.78125,1420.0989583333333,250.78125,1402.9322916666667,250.78125,1385.765625C250.78125,1368.5989583333333,250.78125,1351.4322916666667,250.78125,1335.8489583333333C250.78125,1320.265625,250.78125,1306.265625,266.2935964980207,1280.5546875C281.8059429960413,1254.84375,312.8306359920827,1217.421875,328.34298249010334,1198.7109375L343.85532898812403,1180" id="L-I-F-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-F" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M351.8443600629152,1146L344.55649796909603,1125.7057291666667C337.2686358752768,1105.4114583333333,322.6929116876384,1064.8229166666667,311.293739894238,1027.8242003245812C299.8945681008376,990.8254839824957,291.6719487016752,957.4165929649913,287.560639002094,940.7121474562392L283.4493293025128,924.0077019474871" id="L-F-D-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-D" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M100.99462655425356,1058.7856961554292L100.81388150354462,1053.0271426295242C100.6331364528357,1047.2685891036194,100.27164635141786,1035.7514820518097,100.09090130070892,996.7533451925715C99.91015625,957.7552083333334,99.91015625,891.2760416666666,99.91015625,824.796875C99.91015625,758.3177083333334,99.91015625,691.8385416666666,116.96908942987714,635.2067196382105C134.0280226097543,578.5748976097543,168.14588896950855,531.7904202195085,185.20482214938568,508.39818152438573L202.2637553292628,485.00594282926284" id="L-E-B-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M596.59765625,989.734375L596.59765625,995.484375C596.59765625,1001.234375,596.59765625,1012.734375,596.59765625,1038.7786458333333C596.59765625,1064.8229166666667,596.59765625,1105.4114583333333,596.59765625,1125.7057291666667L596.59765625,1146" id="L-C-M-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-M" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(596.59765625, 625.359375)"><g class="label" transform="translate(-11.328125, -9.5)"><foreignObject width="22.65625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(258.28515625, 625.359375)"><g class="label" transform="translate(-9.3984375, -9.5)"><foreignObject width="18.796875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">No</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(194.76171875, 1024.234375)"><g class="label" transform="translate(-11.328125, -9.5)"><foreignObject width="22.65625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(474.42578125, 1024.234375)"><g class="label" transform="translate(-9.3984375, -9.5)"><foreignObject width="18.796875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">No</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(357.94921875, 1984.84375)"><g class="label" transform="translate(-11.328125, -9.5)"><foreignObject width="22.65625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(250.78125, 1385.765625)"><g class="label" transform="translate(-9.3984375, -9.5)"><foreignObject width="18.796875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">No</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-A-64" transform="translate(308.1171875, 17)"><rect class="basic label-container" style="" rx="0" ry="0" x="-25.0078125" y="-17" width="50.015625" height="34"></rect><g class="label" style="" transform="translate(-17.5078125, -9.5)"><foreignObject width="35.015625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Start</span></div></foreignObject></g></g><g class="node default default" id="flowchart-B-65" transform="translate(308.1171875, 337.4296875)"><polygon points="253.4296875,0 506.859375,-253.4296875 253.4296875,-506.859375 0,-253.4296875" class="label-container" transform="translate(-253.4296875,253.4296875)" style=""></polygon><g class="label" style="" transform="translate(-228.9296875, -9.5)"><foreignObject width="457.859375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">max_batch_size is not None and batch_size &gt;= max_batch_size?</span></div></foreignObject></g></g><g class="node default default" id="flowchart-C-67" transform="translate(596.59765625, 824.796875)"><circle style="" rx="0" ry="0" r="164.9375" width="329.875" height="34"></circle><g class="label" style="" transform="translate(-157.4375, -9.5)"><foreignObject width="314.875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Set batch size to max_batch_size and break</span></div></foreignObject></g></g><g class="node default default" id="flowchart-D-69" transform="translate(258.28515625, 824.796875)"><polygon points="123.375,0 246.75,-123.375 123.375,-246.75 0,-123.375" class="label-container" transform="translate(-123.375,123.375)" style=""></polygon><g class="label" style="" transform="translate(-98.875, -9.5)"><foreignObject width="197.75" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">batch_size &gt;= dataset_size?</span></div></foreignObject></g></g><g class="node default default" id="flowchart-E-71" transform="translate(104.265625, 1163)"><circle style="" rx="0" ry="0" r="104.265625" width="208.53125" height="34"></circle><g class="label" style="" transform="translate(-96.765625, -9.5)"><foreignObject width="193.53125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Halve batch size and break</span></div></foreignObject></g></g><g class="node default default" id="flowchart-F-73" transform="translate(357.94921875, 1163)"><rect class="basic label-container" style="" rx="0" ry="0" x="-95.0625" y="-17" width="190.125" height="34"></rect><g class="label" style="" transform="translate(-87.5625, -9.5)"><foreignObject width="175.125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Try scaling up batch size</span></div></foreignObject></g></g><g class="node default default" id="flowchart-G-75" transform="translate(438.09375, 1334.265625)"><rect class="basic label-container" style="" rx="0" ry="0" x="-101.5859375" y="-17" width="203.171875" height="34"></rect><g class="label" style="" transform="translate(-94.0859375, -9.5)"><foreignObject width="188.171875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Initialize torch GradScaler</span></div></foreignObject></g></g><g class="node default default" id="flowchart-H-77" transform="translate(438.09375, 1437.265625)"><rect class="basic label-container" style="" rx="0" ry="0" x="-93.8359375" y="-17" width="187.671875" height="34"></rect><g class="label" style="" transform="translate(-86.3359375, -9.5)"><foreignObject width="172.671875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Loop for num_iterations</span></div></foreignObject></g></g><g class="node default default" id="flowchart-I-79" transform="translate(357.94921875, 1727.3046875)"><polygon points="223.0390625,0 446.078125,-223.0390625 223.0390625,-446.078125 0,-223.0390625" class="label-container" transform="translate(-223.0390625,223.0390625)" style=""></polygon><g class="label" style="" transform="translate(-198.5390625, -9.5)"><foreignObject width="397.078125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Are inputs and targets generated and moved to device?</span></div></foreignObject></g></g><g class="node default default" id="flowchart-J-81" transform="translate(357.94921875, 2036.34375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-151.8515625" y="-17" width="303.703125" height="34"></rect><g class="label" style="" transform="translate(-144.3515625, -9.5)"><foreignObject width="288.703125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Create model outputs and calculate loss</span></div></foreignObject></g></g><g class="node default default" id="flowchart-K-83" transform="translate(357.94921875, 2120.34375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-187.2578125" y="-17" width="374.515625" height="34"></rect><g class="label" style="" transform="translate(-179.7578125, -9.5)"><foreignObject width="359.515625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Scale loss tensor and perform backward operation</span></div></foreignObject></g></g><g class="node default default" id="flowchart-L-85" transform="translate(179.09765625, 2204.34375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-157.0234375" y="-17" width="314.046875" height="34"></rect><g class="label" style="" transform="translate(-149.5234375, -9.5)"><foreignObject width="299.046875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Perform optimizer step and update scaler</span></div></foreignObject></g></g><g class="node default default" id="flowchart-M-95" transform="translate(596.59765625, 1163)"><rect class="basic label-container" style="" rx="5" ry="5" x="-69.8828125" y="-17" width="139.765625" height="34"></rect><g class="label" style="" transform="translate(-62.3828125, -9.5)"><foreignObject width="124.765625" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Return batch size</span></div></foreignObject></g></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg>